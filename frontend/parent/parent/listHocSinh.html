<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parent Management</title>
    <!-- Liên kết Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Liên kết DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
    <!-- Liên kết FontAwesome nếu bạn cần icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>

<body>
    <div class="container mt-5">
        <table id="studentTable" class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Họ tên</th>
                </tr>
            </thead>
            <tbody id="studentList"></tbody>
        </table>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <!-- Liên kết DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

    <!-- <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Lấy thông tin người dùng từ localStorage
            const user = JSON.parse(localStorage.getItem("userInfo"));

            if (user && user.role === "parent") {
                const parentId = user.id;

                // Gọi API để lấy danh sách học sinh của phụ huynh
                fetch(`https://localhost:7241/api/StudentGrade/by-parent?parentId=${parentId}`)
                    .then(res => res.json())
                    .then(data => {
                        if (!data || data.length === 0) {
                            alert("Phụ huynh chưa có học sinh nào.");
                            return;
                        }

                        // Lấy lớp học từ học sinh đầu tiên
                        const classId = data[0].classId;

                        // Kiểm tra nếu không có classId hợp lệ
                        if (!classId) {
                            alert("Không có thông tin lớp học.");
                            return;
                        }

                        // Gọi API để lấy danh sách học sinh trong lớp
                        fetch(`https://localhost:7241/api/Class/students?classId=${classId}`)
                            .then(res => res.json())
                            .then(classData => {
                                const studentList = document.getElementById("studentList");

                                // Nếu không có học sinh trong lớp, hiển thị thông báo
                                if (!classData || classData.length === 0) {
                                    studentList.innerHTML = "<tr><td colspan='2'>Không có học sinh nào trong lớp.</td></tr>";
                                    return;
                                }

                                // Hiển thị danh sách học sinh
                                studentList.innerHTML = classData.map(student => {
                                    return `
                                <tr>
                                    <td>${student.StuId}</td>
                                    <td>${student.StuName}</td>
                                </tr>
                            `;
                                }).join('');

                                // Khởi tạo DataTable cho bảng
                                $('#studentTable').DataTable({
                                    responsive: true,
                                    language: {
                                        search: "Tìm kiếm:",
                                        lengthMenu: "Hiển thị _MENU_ dòng",
                                        info: "Hiển thị _START_ đến _END_ của _TOTAL_ dòng",
                                        paginate: {
                                            first: "Đầu",
                                            last: "Cuối",
                                            next: "Sau",
                                            previous: "Trước"
                                        }
                                    }
                                });
                            })
                            .catch(error => {
                                console.error("Lỗi khi lấy danh sách học sinh trong lớp: ", error);
                            });
                    })
                    .catch(error => {
                        console.error("Lỗi khi lấy danh sách học sinh của phụ huynh: ", error);
                    });
            } else {
                alert("Không tìm thấy thông tin phụ huynh trong localStorage.");
            }
        });

    </script> -->
</body>

</html>